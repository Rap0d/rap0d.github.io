---
layout: post
title: 52. Naive Bayes
subtitle: Naive Bayes
categories: study
tags: rprogramming
---

![r](/assets/img/logo/r-logo.png)

## Overview

Naive Bayes 알고리즘은 속성을 사용하여 분류를 하고자 할때, 확률의 원리를 활용하는 알고리즘이다.

미래 사건 확률을 추정하기 위해 과거의 데이터를 활용한다.

조건부 확률이라는 개념과 베이즈 정리를 이용하여 만든 알고리즘이다.

> 사용처  
> 스팸 메일 분류  
> 저자 식별과 문서 분류  
> 질병에 대한 진찰

***

## 기본 개념

베이즈 확률 이론은 유사한 증거를 기반으로 한 사건의 유사성을 추정하는 개념에 근거를 두고 있다. 

사건(event)이란 확률을 계산하기 위한 결과의 집합을 의미한다.

예를 들어, 화창하거나 비가 올 날씨, 동전의 앞면과 뒷면 등이다.

***

## 확률(Probability)

사건의 확률은 사건이 일어난 시도의 숫자를 총 사건의 수로 나눈 수를 의미한다.

모든 확률의 총 합은 1이다.

### 베이즈 확률 이론

유사한 증거를 기반으로 한 사건의 유사성을 추정한다.

### 독립 사건

두 개의 사건이 전혀 연관성이 없는 사건을 말한다.

$$P(A\cap B)=P(A)\times P(B)$$

### 종속 사건

두 개의 사건이 서로 연관성이 있는 사건

***

## 확률의 표기법

다음과 같은 도서 대출 현황표가 있다고 가정한다.

> 전체 고객 수 : 100  
> Tensorflow 책을 구매한 고객 수 : 50  
> Database 책을 구매한 고객 수 : 20  
> 두 권 모두를 구매한 고객 수 : 10

이에 대한 확률 표기법은 다음과 같은 항목들이 있다.

| 확률 표현 | 수식 표현 | 설명 |
|:----:|:----:|:----|
| $$P(A)$$ | 50/100 | Tensorflow 책을 구매한 확률 |
| $$P(B)$$ | 20/100 | Database 책을 구매한 확률 |
| $$P(B\mid A)$$ | 10/50 | Tensorflow 책을 구매자 중에서<br>Database 책도 같이 구매한 확률 |
| $$P(A\mid B)$$ | 10/20 | Database 책을 구매자 중에서<br>Tensorflow 책도 같이 구매한 확률 |
| $$P(\sim B)$$ | (100-20)/100 | Database 책을 구매하지 않을 확률 |

***

## 스팸 필터

다음과 같이 전체 메일 중에서 스팸 메일을 걸러 주는 Spam-Filter 기가 있고, 전체 메일에서 스팸 메일은 30%라고 가정하자.

사건 A를 스팸 메일이라고 한다면 표기법은 다음과 같다.

> $$P(A)$$ = 0.3 : 스팸 메일의 확률은 30%이다.  
> $$P(~A)$$ = 0.7 : 스팸 메일이 아닐 확률은 80%이다.

이메일에 '할인'이라는 단어가 들어있을 수 있다.

전체에서 스팸 메일은 30% 차지하고, '할인'이라는 단어가 들어 있는 메일은 20%이다.

스팸 메일이면서, '할인'이라는 단어가 들어 있는 메일은 전체의 10%이다.

> 전체 메일 수 : 100  
> 스팸 메일 수 : 30  
> '할인'이라는 단어가 들어있는 메일 수 : 20  
> 스팸 메일 중에서 '할인'이라는 단어가 들어있는 메일 수 : 10

### 확률 표기

모든 사건들에 대한 확률은 다음과 같다.

| 확률 표현 | 수식 표현 | 설명 |
|:----:|:----:|:----|
| $$P(S)$$ | 30/100 | 스팸 메일의 확률 |
| $$P(B)$$ | 20/100 | '할인'이라는 단어가 들어 있는 메일의 확률 |
| $$P(B\mid S)$$ | 10/30 | 스팸 메일에서 '할인'이라는 단어가 들어 있는 메일의 확률 |
| $$P(S\mid B)$$ | 10/20 | '할인'이라는 단어가 들어 있는 메일중에서 스팸 메일의 확률 |

***

## 조건부 확률

조건부 확률이란 어떠한 사건 A가 일어났다는 전제하에서 다른 사건 B가 발생할 확률을 의미한다. 

수식으로는 $$P(A\mid B)$$라고 표현한다.

확률의 기본 정리인 곱셈 정리를 응용한 것이다.

$$P(A\mid B)={{P(B\mid A)\times P(A)}\over P(B)}={P(A\cap B)\over P(B)}$$

### 예시

주사위를 두 번 던져서 "첫번째가 3", "두번째가 짝수"가 될 확률은 다음과 같다.

3은 확률이 1/6이고, 짝수는 3/6=1/2이므로, 곱셈 법칙에 의하여 1/6*1/2 = 1/12이다.

만약 두 사건이 독립 사건이라면 다음과 같은 공식이 성립한다.

$$P(A\cap B)=P(A)\times P(B)$$

$$P(A\cap B)$$ 는 두 개의 사건이 동시에 일어날 확률을 의미한다.
